import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix
import pickle

from sklearn.externals import joblib
import os
import csv


sensor_data = pd.read_csv('CA_Forest_Dataset_Final.csv')
X = sensor_data.values[:, 0:6]
Y = sensor_data.values[:,6]

print(X)
print(Y)

#X_train, X_test, y_train, y_test = train_test_split( X, Y, test_size = 0.3, random_state = 100)
#N,N everytime for Fires = Y

X_train, X_test, y_train, y_test = train_test_split( X, Y, test_size = 0.3)

clf = GaussianNB()
clf.fit(X_train, y_train)

y_pred = clf.predict(X_test)
y_pred

print("Accuracy for Naive Bayes Classifier is ", accuracy_score(y_test,y_pred)*100)

result1 = clf.predict([[33.6,-116.2,-36,6.04,0.1,99], [33.3,-117.3,22.9,9.84,1.25,59],
                       [34.2,-118.5,234.7,10.51,6.51,52], [38.5,-121.5,4.6,2.24,0,61]])
print('N : The predicted result using RF for Case 1, Case 2, Case 3 and Case 4  is: ')
print(result1)

result2 = clf.predict([[34.8,-114.6,271.3,6.04,0.1,115], [40.5,-122.3,151.5,9.84,0.94,58],
                       [40.5,-120.3,2545.7,1.12,1.6,72], [33.6,-116.2,-36,9.62,0,89],
                        [34.7,-118.2,712.6,6.93,0.22,101],
                        [37.3,-120.5,46.3,5.82,0.02,102],
                        [33.6,-116.2,-36,11.18,0.01,104],
                        [34.8,-114.6,271.3,6.04,0.1,115],
                        [38.9,-120.0,1924.5,5.82,0.1,41],
                        [37.3,-120.5,46.3,5.14,0.01,46],
                        [38.9,-120.0,1924.5,10.51,0.17,48],
                        [39.5,-121.6,57.9,8.95,0.35,49],
                        [37.3,-120.5,46.3,1.12,0.01,50],
                        [38.0,-122.1,5.5,8.5,0.17,51],
                        [41.0,-124.1,61,3.8,0.28,51],
                        [38.9,-120.0,1924.5,12.3,0.34,53],
                        [38.9,-120.0,1924.5,12.3,0.34,53],
                        [38.9,-120.0,1924.5,19.46,0.01,53],
                        [34.0,-117.4,245.2,3.8,0.3,55],
                        [36.9,-121.8,48.8,2.91,0.42,55],
                        [38.4,-119.5,2838.6,1.12,0.3,56],
                        [33.0,-116.9,424.6,7.16,1.05,56],
                        [38.4,-119.5,2838.6,1.12,0.3,56],
                        [33.0,-116.9,424.6,7.16,1.05,56],
                        [37.0,-120.1,77.1,5.59,0.03,56],
                        [37.3,-120.5,46.3,7.83,0.1,56],
                        [37.0,-120.1,77.1,3.8,0.1,56],
                        [38.9,-120.0,1924.5,1.79,0.23,57],
                        [41.8,-124.2,17.1,11.41,0.08,58],
                        [41.8,-124.2,17.1,3.58,0.01,58],
                        [32.7,-117.2,4.6,4.47,0.06,59],
                        [34.0,-117.4,245.2,4.47,0.1,59],
                        [41.8,-124.2,17.1,9.62,0.24,59],
                        [41.8,-124.2,17.1,2.01,0.01,60],
                        [39.5,-121.6,57.9,8.05,0.37,60],
                        [36.9,-121.8,48.8,10.07,0.04,60],
                        [41.0,-124.1,61,7.16,0.01,61],
                        [37.7,-122.2,1.8,11.41,0.06,61],
                        [41.8,-124.2,17.1,4.7,0.03,61],
                        [38.4,-119.5,2838.6,1.79,0.1,62],
                        [41.8,-124.2,17.1,3.58,0.03,62],
                        [41.0,-124.1,61,3.13,0.01,62],
                        [39.5,-121.6,57.9,3.58,0.2,63],
                        [37.3,-120.5,46.3,4.25,0.21,63],
                        [41.8,-124.2,17.1,8.95,0.02,63],
                        [37.0,-120.1,77.1,4.92,0.19,63],
                        [41.8,-124.2,17.1,3.58,0.01,63],
                        [37.4,-121.9,15.5,7.61,0.02,64],
                        [36.7,-121.6,22.6,10.29,0.01,64],
                        [36.7,-121.6,22.6,10.29,0.01,64],
                        [36.7,-121.6,22.6,10.29,0.01,64],
                        [36.7,-121.6,22.6,10.29,0.01,64],
                        [39.5,-121.6,57.9,6.49,0.01,64],
                        [34.0,-117.4,245.2,8.95,0.07,64],
                        [33.0,-116.9,424.6,9.4,0.51,64],
                        [34.0,-117.4,245.2,4.25,0.06,64],
                        [41.0,-124.1,61,9.4,0.01,64],
                        [41.0,-124.1,61,7.83,0.01,64],
                        [39.5,-121.6,57.9,10.29,0.03,64],
                        [39.1,-121.6,18.9,6.26,0.18,65],
                        [41.0,-124.1,61,2.68,0.01,65],
                        [41.8,-124.2,17.1,10.29,0.1,65],
                        [41.8,-124.2,17.1,3.36,0.01,65],
                        [33.7,-117.9,16.5,6.93,0.05,66],
                        [36.7,-121.6,22.6,9.17,0.02,66],
                        [39.2,-120.3,2447.2,2.24,0.1,66],
                        [38.4,-119.5,2838.6,1.12,0.1,66],
                        [41.8,-124.2,17.1,6.71,0.01,66],
                        [38.4,-119.5,2838.6,4.03,0.1,67],
                        [37.3,-120.5,46.3,5.37,0.11,67],
                        [37.3,-120.5,46.3,12.53,0.25,67],
                        [33.6,-114.7,120.4,12.08,0.07,67],
                        [39.1,-123.2,183.2,5.14,0.27,67],
                        [36.9,-121.8,48.8,3.8,0.01,68],
                        [36.9,-121.8,48.8,3.8,0.01,68],
                        [41.0,-124.1,61,12.97,0.11,68],
                        [37.0,-120.1,77.1,12.08,0.25,68],
                        [41.8,-124.2,17.1,5.82,0.04,68],
                        [41.0,-124.1,61,7.83,0.01,68],
                        [41.0,-124.1,61,7.83,0.01,68],
                        [33.0,-116.9,424.6,7.38,0.09,69],
                        [33.9,-118.0,29.3,3.36,0.01,69],
                        [34.0,-118.3,54.6,2.24,0.03,69],
                        [33.9,-118.4,29.6,8.28,0.02,69],
                        [33.9,-118.4,29.6,8.28,0.02,69],
                        [39.5,-121.6,57.9,13.87,0.1,69],
                        [39.2,-120.3,2447.2,3.13,0.1,69],
                        [35.2,-120.6,61,9.62,0.02,70],
                        [38.4,-119.5,2838.6,1.79,0.3,70],
                        [33.0,-116.9,424.6,3.8,0.13,70],
                        [32.6,-117.0,157,5.37,0.04,71],
                        [38.9,-120.0,1924.5,6.04,0.01,71],
                        [33.0,-116.9,424.6,4.47,0.01,71],
                        [34.0,-117.4,245.2,7.38,0.05,72],
                        [39.4,-120.3,2545.7,1.12,1.6,72],
                        [39.4,-120.3,2545.7,1.12,1.6,72],
                        [39.5,-121.6,57.9,8.95,0.41,73],
                        [36.9,-121.8,48.8,6.26,0.02,73],
                        [36.9,-121.8,48.8,6.26,0.02,73],
                        [39.2,-120.3,2447.2,3.13,0.2,73],
                        [38.4,-119.5,2838.6,2.46,0.1,75],
                        [39.2,-120.3,2447.2,2.68,0.1,75],
                        [39.4,-120.3,2545.7,0.89,0.2,75],
                        [33.0,-116.9,424.6,2.24,1.25,75],
                        [34.8,-114.6,271.3,14.54,0.01,76],
                        [38.9,-120.0,1924.5,5.59,0.03,76],
                        [37.0,-120.1,77.1,9.62,0.16,77],
                        [37.0,-120.1,77.1,9.62,0.16,77],
                        [34.0,-117.4,245.2,4.03,0.01,78],
                        [37.0,-120.1,77.1,10.51,0.04,78],
                        [34.7,-118.7,1374.6,7.83,0.02,79],
                        [34.7,-118.7,1374.6,7.83,0.02,79],
                        [38.9,-120.0,1924.5,2.91,0.54,79],
                        [34.2,-119.2,11,6.26,0.12,79],
                        [34.7,-118.7,1374.6,14.09,0.64,80],
                        [41.5,-120.6,1333.5,5.59,0.07,81],
                        [36.9,-121.8,48.8,2.91,0.01,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [33.8,-116.5,124.7,5.37,0.54,82],
                        [39.4,-120.3,2545.7,1.57,0.1,82],
                        [37.6,-121.0,22.3,7.61,0.16,83],
                        [35.2,-120.6,61,3.58,0.01,83],
                        [33.0,-116.9,424.6,3.8,0.18,84],
                        [35.2,-120.6,61,3.36,0.04,84],
                        [35.2,-120.6,61,3.36,0.04,84],
                        [35.2,-120.6,61,3.36,0.04,84],
                        [33.6,-116.2,-36,4.47,0.5,85],
                        [33.6,-116.2,-36,4.47,0.5,85],
                        [33.6,-116.2,-36,6.71,0.53,85],
                        [37.3,-120.5,46.3,5.82,0.05,87],
                        [35.2,-120.6,61,6.49,1.32,88],
                        [37.4,-118.4,1250.3,7.61,0.09,90],
                        [34.7,-118.7,1374.6,9.17,0.05,90],
                        [33.0,-116.9,424.6,3.58,0.01,90],
                        [35.2,-120.6,61,4.92,0.02,90],
                        [33.0,-116.9,424.6,4.7,0.01,91],
                        [33.6,-116.2,-36,8.5,0.41,93],
                        [32.6,-116.5,805,4.7,0.26,94],
                        [33.0,-116.9,424.6,4.92,0.01,96],
                        [33.0,-116.9,424.6,4.03,0.01,96],
                        [33.6,-114.7,120.4,10.07,0.02,96],
                        [34.6,-118.1,769.2,5.59,0.12,97],
                        [33.8,-116.5,124.7,7.16,0.34,97],
                        [33.8,-116.5,124.7,7.16,0.34,97],
                        [33.0,-116.9,424.6,4.7,0.01,97],
                        [33.8,-116.5,124.7,4.03,0.27,98],
                       ] )
print('Y : The predicted result using RF for Case 5, Case 6, Case 7 and Case 8 is: ')
print(result2)

#Tested algorithm for 150 cases and found that it does not give correct result for Fire = Y

filename = 'model_NB.sav'
pickle.dump(clf, open(filename, 'wb'))